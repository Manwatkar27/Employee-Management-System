<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Employee Management System</title>
    <!-- THIS IS THE CRUCIAL LINE THAT WAS MISSING -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .navbar {
            background-color: #343a40 !important;
        }
        .table-hover tbody tr:hover {
            background-color: #e9ecef;
        }
        .modal-header, .modal-footer {
            border: none;
        }
        .btn-custom-delete {
            background-color: #dc3545;
            color: white;
        }
         .btn-custom-delete:hover {
            background-color: #c82333;
            color: white;
        }
    </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="#">Employee Management System</a>
    </div>
</nav>

<!-- Main Content -->
<div class="container my-4">
    <div class="card shadow-sm">
        <div class="card-header d-flex justify-content-between align-items-center">
            <h4>All Employee List</h4>
            <div>
                <!-- Buttons to trigger modals -->
                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addEmployeeModal">Add Employee</button>
                <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteAllModal">Delete All</button>
            </div>
        </div>
        <div class="card-body">
            <!-- Employee Table -->
            <div class="table-responsive">
                <table class="table table-striped table-hover text-center">
                    <thead class="table-dark">
                    <tr>
                        <th scope="col">ID</th>
                        <th scope="col">Name</th>
                        <th scope="col">Email</th>
                        <th scope="col">Phone</th>
                        <th scope="col">Gender</th>
                        <th scope="col">Salary</th>
                        <th scope="col">Role</th>
                        <th scope="col">Action</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- Loop through employees -->
                    <tr th:each="emp : ${allEmp}">
                        <td th:text="${emp.id}"></td>
                        <td th:text="${emp.employeeName}"></td>
                        <td th:text="${emp.employeeEmail}"></td>
                        <td th:text="${emp.employeePhone}"></td>
                        <td th:text="${emp.employeeGender}"></td>
                        <td th:text="${emp.employeeSalary}"></td>
                        <td th:text="${emp.employeeRole}"></td>
                        <td>
                            <!-- Action Buttons -->
                            <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#updateEmployeeModal"
                                    th:attr="data-id=${emp.id},
                                             data-name=${emp.employeeName},
                                             data-email=${emp.employeeEmail},
                                             data-phone=${emp.employeePhone},
                                             data-gender=${emp.employeeGender},
                                             data-salary=${emp.employeeSalary},
                                             data-role=${emp.employeeRole}">
                                Update
                            </button>
                            <button class="btn btn-sm btn-custom-delete" data-bs-toggle="modal" data-bs-target="#deleteEmployeeModal"
                                    th:attr="data-id=${emp.id}">
                                Delete
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Add Employee Modal -->
<div class="modal fade" id="addEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <form class="p-2" th:action="@{/create}" th:object="${employee}" method="post">
                    <h4 class="text-center mb-4">Add Employee</h4>
                    <div class="row p-2">
                        <input type="text" th-field="*{employeeName}" class="form-control" placeholder="Employee name" required>
                    </div>
                    <div class="row p-2">
                        <input type="email" th-field="*{employeeEmail}" class="form-control" placeholder="Email address" required>
                    </div>
                    <div class="row p-2">
                        <input type="tel" th-field="*{employeePhone}" class="form-control" placeholder="Phone number" required>
                    </div>
                    <div class="row p-2">
                        <select th-field="*{employeeGender}" class="form-select" required>
                            <option value="" selected>Select gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                    <div class="row p-2">
                        <input type="number" th-field="*{employeeSalary}" class="form-control" placeholder="Salary" required>
                    </div>
                    <div class="row p-2">
                        <select th-field="*{employeeRole}" class="form-select" required>
                            <option value="" selected>Select role</option>
                            <option value="Java Developer">Java Developer</option>
                            <option value="Python Developer">Python Developer</option>
                            <option value="Web Developer">Web Developer</option>
                            <option value="Android Developer">Android Developer</option>
                            <option value="UI Developer">UI Developer</option>
                        </select>
                    </div>
                    <div class="d-grid gap-2 mt-3">
                        <button type="submit" class="btn btn-success">Add Employee</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Update Employee Modal -->
<div class="modal fade" id="updateEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <form id="updateForm" class="p-2" th:action="@{/update}" method="post">
                    <h4 class="text-center mb-4">Update Employee</h4>
                    <input type="hidden" id="updateId" name="id">
                    <div class="row p-2">
                        <input type="text" id="updateName" name="employeeName" class="form-control" required>
                    </div>
                    <div class="row p-2">
                        <input type="email" id="updateEmail" name="employeeEmail" class="form-control" required>
                    </div>
                    <div class="row p-2">
                        <input type="tel" id="updatePhone" name="employeePhone" class="form-control" required>
                    </div>
                    <div class="row p-2">
                        <select id="updateGender" name="employeeGender" class="form-select" required>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                    <div class="row p-2">
                        <input type="number" id="updateSalary" name="employeeSalary" class="form-control" required>
                    </div>
                    <div class="row p-2">
                        <select id="updateRole" name="employeeRole" class="form-select" required>
                            <option value="Java Developer">Java Developer</option>
                            <option value="Python Developer">Python Developer</option>
                            <option value="Web Developer">Web Developer</option>
                            <option value="Android Developer">Android Developer</option>
                            <option value="UI Developer">UI Developer</option>
                        </select>
                    </div>
                    <div class="d-grid gap-2 mt-3">
                        <button type="submit" class="btn btn-success">Update Employee</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Delete Employee Modal -->
<div class="modal fade" id="deleteEmployeeModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center">
                <form th:action="@{/remove}" method="post">
                    <h5 class="mb-3">Are you sure you want to delete this employee?</h5>
                    <input type="hidden" id="deleteId" name="id">
                    <button type="submit" class="btn btn-danger me-2">Yes, Delete</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </form>
            </div>
        </div>
    </div>
</div>


<!-- Delete All Modal -->
<div class="modal fade" id="deleteAllModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <form class="p-2" th:action="@{/remove/all}" th:object="${confirmationForm}" method="post">
                    <h4 class="text-center mb-3">Delete All Employees</h4>
                    <p class="text-muted">This action cannot be undone. To confirm, please type "<b>Yes</b>" in the box below.</p>
                    <div class="row p-2">
                        <input type="text" th:field="*{confirmation}" class="form-control" placeholder="Type Yes to confirm" required>
                    </div>
                    <div class="d-grid gap-2 mt-3">
                        <button type="submit" class="btn btn-danger">Confirm Deletion</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS Bundle for modals to work -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom JavaScript -->
<script>
    // Script for populating the Update modal with employee data
    const updateEmployeeModal = document.getElementById('updateEmployeeModal');
    updateEmployeeModal.addEventListener('show.bs.modal', event => {
        const button = event.relatedTarget;
        const id = button.getAttribute('data-id');
        const name = button.getAttribute('data-name');
        const email = button.getAttribute('data-email');
        const phone = button.getAttribute('data-phone');
        const gender = button.getAttribute('data-gender');
        const salary = button.getAttribute('data-salary');
        const role = button.getAttribute('data-role');

        document.getElementById('updateId').value = id;
        document.getElementById('updateName').value = name;
        document.getElementById('updateEmail').value = email;
        document.getElementById('updatePhone').value = phone;
        document.getElementById('updateGender').value = gender;
        document.getElementById('updateSalary').value = salary;
        document.getElementById('updateRole').value = role;
    });

    // Script for setting the employee ID in the Delete modal
    const deleteEmployeeModal = document.getElementById('deleteEmployeeModal');
    deleteEmployeeModal.addEventListener('show.bs.modal', event => {
        const button = event.relatedTarget;
        const id = button.getAttribute('data-id');
        document.getElementById('deleteId').value = id;
    });
</script>

</body>
</html>

